import pandas as pd
import matplotlib.pyplot as plt

# Sample ILI data organized into a DataFrame (replace with your actual data)
data = {
    'Pre-Odor Paired': [
        [0],
        [0],
        [0],
        [0],
        [259,101,121,110,123,124,126,137,124,133,140,141,146,153,134,141,122,158,112,152,146,139,140,123,144,137,146,140,142,130,145,143,130,151,126,146],
        [102,94,106,114,112,118,126,120,133,122,129,126,121,120,138,136,135,137,154,136,136,127,138,141,154,144,136,134,143,142,139,156,145,121,150,148,150],
        [109,96,125,102,134,120,134,117,133,131,123,136,121,141,130,133,137,143,141,140,144,139,156,287,138,138,134,138,133,140,131,145,145,140,131,141],
        [101,98,115,107,113,122,114,129,125,113,128,119,119,138,131,131,127,139,138,122,128,135,126,142,134,132,134,123,143,132,135,117,120,128,140,139,141,118,137],
        [98,114,112,112],
        [111,117,136,129,122,732,102,136,702,901,124,677],
        [148,100,257,122,124,123,131,150,143,134,135,126,173,117,127,129,135,124,133,131,136,133,134,147,136,137,142,124,146,141,141,142,144,141,147,142],
        [117,117,120,119,245,127,138,114,130,125,128,122,142,134,111,133,125,133,123,131,136,133,126,139,123,144,140,137,138,125,142,127,144,130,145,142,122],
        [110,94,112,115,122,106,124,144,115,125,112,130,126,130,129,135,128,136,130,130,131,133,142,136,144,152,140,122,144,135,277,134,116,133,132,135,149],
        [121,151,1590],
        [0],
        [0],
        [110,265,131],
        [120,112,104,120,126,129,118,136,116,134,120,121,125,123,128,126,129,137,133,120,133,129,128,129,142,126,145,136,137,144,183,152,137,134,138,140,137,136],
        [113,1980,105,106],
        [0],
        [0],
        [0],
        [230,119,124,117,123,118,123,121,124,118,128,127,125,121,127,126,129,124,128,129,973,98,126,135,130,134,137,134,139,137,131,139],
        [0],
        [115,106,107,123,117,133,117,131,116,129,118,125,122,119,140,131,130,138,132,140,123,139,123,127,174,134,122,144,130,128,142,125,140,154,145,143,125,143],
        [0],
        [0],
        [0],
        [0],
        [0],
    ],
        
    'Post-Odor Paired': [
        [0],
        [0],
        [0],
        [0],
        [259,101,121,110,123,124,126,137,124,133,140,141,146,153,134,141,122,158,112,152,146,139,140,123,144,137,146,140,142,130,145,143,130,151,126,146],
        [102,94,106,114,112,118,126,120,133,122,129,126,121,120,138,136,135,137,154,136,136,127,138,141,154,144,136,134,143,142,139,156,145,121,150,148,150],
        [109,96,125,102,134,120,134,117,133,131,123,136,121,141,130,133,137,143,141,140,144,139,156,287,138,138,134,138,133,140,131,145,145,140,131,141],
        [101,98,115,107,113,122,114,129,125,113,128,119,119,138,131,131,127,139,138,122,128,135,126,142,134,132,134,123,143,132,135,117,120,128,140,139,141,118,137],
        [98,114,112,112],
        [111,117,136,129,122,732,102,136,702,901,124,677],
        [148,100,257,122,124,123,131,150,143,134,135,126,173,117,127,129,135,124,133,131,136,133,134,147,136,137,142,124,146,141,141,142,144,141,147,142],
        [117,117,120,119,245,127,138,114,130,125,128,122,142,134,111,133,125,133,123,131,136,133,126,139,123,144,140,137,138,125,142,127,144,130,145,142,122],
        [110,94,112,115,122,106,124,144,115,125,112,130,126,130,129,135,128,136,130,130,131,133,142,136,144,152,140,122,144,135,277,134,116,133,132,135,149],
        [121,151,1590],
        [0],
        [0],
        [110,265,131],
        [120,112,104,120,126,129,118,136,116,134,120,121,125,123,128,126,129,137,133,120,133,129,128,129,142,126,145,136,137,144,183,152,137,134,138,140,137,136],
        [113,1980,105,106],
        [0],
        [0],
        [0],
        [230,119,124,117,123,118,123,121,124,118,128,127,125,121,127,126,129,124,128,129,973,98,126,135,130,134,137,134,139,137,131,139],
        [0],
        [115,106,107,123,117,133,117,131,116,129,118,125,122,119,140,131,130,138,132,140,123,139,123,127,174,134,122,144,130,128,142,125,140,154,145,143,125,143],
        [0],
        [0],
        [0],
        [0],
        [0],
    ],
    'Pre-Odor Unpaired': [
        [0],
        [0],
        [176,87,102,195,110,107,116,121,127,129,139,114,131,124,113,120,115,141,110,253,111,151,110,121,140,137,112,157,121,123,135,134,125,130,139,117,127,137],
        [0],
        [0],
        [113,192,101,108,108,120,127,120,110,113,125,118,120,123,129,234,134,129,139,127,129,141,135,148,125,124,121,137,126,135,135,137,137,142,144,129,147],
        [119,103,94,109,116,123,120,132,115,137,124,121,143,134,134,125,139,131,141,142,158,128,148,138,141,137,145,127,151,145,139,132,131,152,137,134,131],
        [103,109,104,111,128,120,135,123,128,124,131,155,141,140,129,132,134,141,140,134,146,147,146,131,205,155,236,129,134,146,153,138,139,148,154],
        [121,104,96,116,117,118,132,120,131,117,131,129,125,129,121,134,128,131,128,133,143,142,130,138,144,145,136,137,148,139,134,144,130,141,137,132,132,140],
        [111,142,807,103,90,108,121,117,123,120,122,121,117,116,125,131,100,120,133,126,133,120,129,145,129,115,129,134,114,124,148,122,126,130,131],
        [204,115,94,119,112,122,127,127,133,123,127,118,135,150,117,129,120,129,123,125,119,133,155,113,141,130,129,137,127,151,118,124,129,134,132,128,144,133],
        [117,99,93,123,105,130,123,120,120,128,136,127,121,124,128,120,133,126,137,141,116,139,133,125,125,127,126,144,116,124,129,133,146,160,125,126,122,134,125],
        [111,104,109,105,119,119,120,121,116,121,126,117,133,123,122,143,115,119,122,121,123,152,116,129,125,135,124,144,112,138,139,131,125,131,120,130,142,134,124,133],
        [100,95,112,116,119,118,110,122,124,122,114,121,140,129,114,121,128,129,129,117,150,121,120,133,133,127,124,127,155,133,122,126,144,122,131,123,135,148,145],
        [107,99,121,116,125,114,121,119,120,127,121,126,141,111,136,117,120,123,126,130,144,127,118,126,131,125,144,133,124,129,126,128,138,133,153,123,122,122,130],
        [107,104,105,108,124,117,120,122,122,122,123,128,126,143,123,122,125,124,146,114,133,130,136,137,158,164,169,168,200],
        [113,97,108,115,114,114,121,110,117,122,118,124,127,124,127,127,130,130,139,131,119,125,140,128,126,129,137,133,128,133,133,129,134,129,129,144,130,128,137],
        [104,115,115,120,121,122,113,120,125,126,126,129,131,139,130,132,133,131,135,133,132,146,139,132,123,134,126,128,128,131,129,139,134,128,128,136,129,144],
        [108,107,112,117,121,121,124,123,121,116,122,124,123,133,114,116,123,127,125,139,133,119,125,130,122,131,129,120,146,135,119,125,127,141,127,160,138,191],
        [107,103,114,110,121,102,123,118,117,121,120,122,116,125,126,118,141,120,119,125,130,125,125,128,143,131,122,121,134,137,337,134,118,128,149,123,128,125],
        [110,114,131,994,96],
        [137,115,97,108,103,122,118,310,114,112,116,118,120,121,119,131,115,117,110,127,113,141,126,115,119,143,124,129,117,131,123,130,138,119,142,130,117,135,131],
        [0],
        [0],
        [104,115,117],
        [0],
        [113,116,121,122,132,121,106,129,119,121,123,124,127,129,121,127,127,130,126,126,151,135,129,138,140,140,131,129,131,129,133,132,135,138,140,144],
        [0],
        [0],
        [0],
    ],
    'Post-Odor Unpaired': [
       [0],
       [0],
       [176,87,102,195,110,107,116,121,127,129,139,114,131,124,113,120,115,141,110,253,111,151,110,121,140,137,112,157,121,123,135,134,125,130,139,117,127,137],
       [0],
       [0],
       [113,192,101,108,108,120,127,120,110,113,125,118,120,123,129,234,134,129,139,127,129,141,135,148,125,124,121,137,126,135,135,137,137,142,144,129,147],
       [119,103,94,109,116,123,120,132,115,137,124,121,143,134,134,125,139,131,141,142,158,128,148,138,141,137,145,127,151,145,139,132,131,152,137,134,131],
       [103,109,104,111,128,120,135,123,128,124,131,155,141,140,129,132,134,141,140,134,146,147,146,131,205,155,236,129,134,146,153,138,139,148,154],
       [121,104,96,116,117,118,132,120,131,117,131,129,125,129,121,134,128,131,128,133,143,142,130,138,144,145,136,137,148,139,134,144,130,141,137,132,132,140],
       [111,142,807,103,90,108,121,117,123,120,122,121,117,116,125,131,100,120,133,126,133,120,129,145,129,115,129,134,114,124,148,122,126,130,131],
       [204,115,94,119,112,122,127,127,133,123,127,118,135,150,117,129,120,129,123,125,119,133,155,113,141,130,129,137,127,151,118,124,129,134,132,128,144,133],
       [117,99,93,123,105,130,123,120,120,128,136,127,121,124,128,120,133,126,137,141,116,139,133,125,125,127,126,144,116,124,129,133,146,160,125,126,122,134,125],
       [111,104,109,105,119,119,120,121,116,121,126,117,133,123,122,143,115,119,122,121,123,152,116,129,125,135,124,144,112,138,139,131,125,131,120,130,142,134,124,133],
       [100,95,112,116,119,118,110,122,124,122,114,121,140,129,114,121,128,129,129,117,150,121,120,133,133,127,124,127,155,133,122,126,144,122,131,123,135,148,145],
       [107,99,121,116,125,114,121,119,120,127,121,126,141,111,136,117,120,123,126,130,144,127,118,126,131,125,144,133,124,129,126,128,138,133,153,123,122,122,130],
       [107,104,105,108,124,117,120,122,122,122,123,128,126,143,123,122,125,124,146,114,133,130,136,137,158,164,169,168,200],
       [113,97,108,115,114,114,121,110,117,122,118,124,127,124,127,127,130,130,139,131,119,125,140,128,126,129,137,133,128,133,133,129,134,129,129,144,130,128,137],
       [104,115,115,120,121,122,113,120,125,126,126,129,131,139,130,132,133,131,135,133,132,146,139,132,123,134,126,128,128,131,129,139,134,128,128,136,129,144],
       [108,107,112,117,121,121,124,123,121,116,122,124,123,133,114,116,123,127,125,139,133,119,125,130,122,131,129,120,146,135,119,125,127,141,127,160,138,191],
       [107,103,114,110,121,102,123,118,117,121,120,122,116,125,126,118,141,120,119,125,130,125,125,128,143,131,122,121,134,137,337,134,118,128,149,123,128,125],
       [110,114,131,994,96],
       [137,115,97,108,103,122,118,310,114,112,116,118,120,121,119,131,115,117,110,127,113,141,126,115,119,143,124,129,117,131,123,130,138,119,142,130,117,135,131],
       [0],
       [0],
       [104,115,117],
       [0],
       [113,116,121,122,132,121,106,129,119,121,123,124,127,129,121,127,127,130,126,126,151,135,129,138,140,140,131,129,131,129,133,132,135,138,140,144],
       [0],
       [0],
       [0],
     ],
}
df = pd.DataFrame(data)

condition_names = df.columns

average_cluster_sizes = []

for condition in condition_names:
    clusters = []
    
    for trial in df[condition]:
        current_cluster = 0
        for ILI in trial:
            if ILI <= 400:
                current_cluster += 1
            elif current_cluster > 0:
                clusters.append(current_cluster)
                current_cluster = 0
        
        # Add the last cluster if not omitted
        if current_cluster > 0:
            clusters.append(current_cluster)

    # Omit clusters of size 2, 1, or 0
    clusters = [cluster for cluster in clusters if cluster > 1]

    # Calculate average cluster size
    if clusters:
        average_size = sum(clusters) / len(clusters)
        average_cluster_sizes.append(average_size)
    else:
        average_cluster_sizes.append(0)

# Plot the results
plt.bar(condition_names, average_cluster_sizes)
plt.ylabel('Average Cluster Size')
plt.title('Average Cluster Size in Different Conditions')
plt.show()


